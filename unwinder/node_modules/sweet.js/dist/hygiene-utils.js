"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.CollectBindingSyntax = undefined;

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

exports.collectBindings = collectBindings;

var _symbol = require("./symbol");

var _transforms = require("./transforms");

var _ramda = require("ramda");

var _ = _interopRequireWildcard(_ramda);

var _errors = require("./errors");

var _terms = require("./terms");

var _terms2 = _interopRequireDefault(_terms);

var _immutable = require("immutable");

var _astDispatcher = require("./ast-dispatcher");

var _astDispatcher2 = _interopRequireDefault(_astDispatcher);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var CollectBindingSyntax = exports.CollectBindingSyntax = function (_ASTDispatcher) {
  _inherits(CollectBindingSyntax, _ASTDispatcher);

  function CollectBindingSyntax() {
    _classCallCheck(this, CollectBindingSyntax);

    var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(CollectBindingSyntax).call(this, "collect", true));

    _this.names = (0, _immutable.List)();
    return _this;
  }

  _createClass(CollectBindingSyntax, [{
    key: "collect",
    value: function collect(term_322) {
      return this.dispatch(term_322);
    }
  }, {
    key: "collectBindingIdentifier",
    value: function collectBindingIdentifier(term_323) {
      return this.names.concat(term_323.name);
    }
  }, {
    key: "collectBindingPropertyIdentifier",
    value: function collectBindingPropertyIdentifier(term_324) {
      return this.collect(term_324.binding);
    }
  }, {
    key: "collectBindingPropertyProperty",
    value: function collectBindingPropertyProperty(term_325) {
      return this.collect(term_325.binding);
    }
  }, {
    key: "collectArrayBinding",
    value: function collectArrayBinding(term_326) {
      var _this2 = this;

      var restElement_327 = null;
      if (term_326.restElement != null) {
        restElement_327 = this.collect(term_326.restElement);
      }
      return this.names.concat(restElement_327).concat(term_326.elements.filter(function (el_328) {
        return el_328 != null;
      }).flatMap(function (el_329) {
        return _this2.collect(el_329);
      }));
    }
  }, {
    key: "collectObjectBinding",
    value: function collectObjectBinding(term_330) {
      var _this3 = this;

      return term_330.properties.flatMap(function (prop_331) {
        return _this3.collect(prop_331);
      });
    }
  }]);

  return CollectBindingSyntax;
}(_astDispatcher2.default);

function collectBindings(term_332) {
  return new CollectBindingSyntax().collect(term_332);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3N3ZWV0L2h5Z2llbmUtdXRpbHMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O1FBbUNnQixlLEdBQUEsZTs7QUFuQ2hCOztBQUNBOztBQUNBOztJQUFhLEM7O0FBQ2I7O0FBQ0E7Ozs7QUFDQTs7QUFDQTs7Ozs7Ozs7Ozs7Ozs7SUFDYSxvQixXQUFBLG9COzs7QUFDWCxrQ0FBYztBQUFBOztBQUFBLHdHQUNOLFNBRE0sRUFDSyxJQURMOztBQUVaLFVBQUssS0FBTCxHQUFhLHNCQUFiO0FBRlk7QUFHYjs7Ozs0QkFDTyxRLEVBQVU7QUFDaEIsYUFBTyxLQUFLLFFBQUwsQ0FBYyxRQUFkLENBQVA7QUFDRDs7OzZDQUN3QixRLEVBQVU7QUFDakMsYUFBTyxLQUFLLEtBQUwsQ0FBVyxNQUFYLENBQWtCLFNBQVMsSUFBM0IsQ0FBUDtBQUNEOzs7cURBQ2dDLFEsRUFBVTtBQUN6QyxhQUFPLEtBQUssT0FBTCxDQUFhLFNBQVMsT0FBdEIsQ0FBUDtBQUNEOzs7bURBQzhCLFEsRUFBVTtBQUN2QyxhQUFPLEtBQUssT0FBTCxDQUFhLFNBQVMsT0FBdEIsQ0FBUDtBQUNEOzs7d0NBQ21CLFEsRUFBVTtBQUFBOztBQUM1QixVQUFJLGtCQUFrQixJQUF0QjtBQUNBLFVBQUksU0FBUyxXQUFULElBQXdCLElBQTVCLEVBQWtDO0FBQ2hDLDBCQUFrQixLQUFLLE9BQUwsQ0FBYSxTQUFTLFdBQXRCLENBQWxCO0FBQ0Q7QUFDRCxhQUFPLEtBQUssS0FBTCxDQUFXLE1BQVgsQ0FBa0IsZUFBbEIsRUFBbUMsTUFBbkMsQ0FBMEMsU0FBUyxRQUFULENBQWtCLE1BQWxCLENBQXlCO0FBQUEsZUFBVSxVQUFVLElBQXBCO0FBQUEsT0FBekIsRUFBbUQsT0FBbkQsQ0FBMkQ7QUFBQSxlQUFVLE9BQUssT0FBTCxDQUFhLE1BQWIsQ0FBVjtBQUFBLE9BQTNELENBQTFDLENBQVA7QUFDRDs7O3lDQUNvQixRLEVBQVU7QUFBQTs7QUFDN0IsYUFBTyxTQUFTLFVBQVQsQ0FBb0IsT0FBcEIsQ0FBNEI7QUFBQSxlQUFZLE9BQUssT0FBTCxDQUFhLFFBQWIsQ0FBWjtBQUFBLE9BQTVCLENBQVA7QUFDRDs7Ozs7O0FBRUksU0FBUyxlQUFULENBQXlCLFFBQXpCLEVBQW1DO0FBQ3hDLFNBQVEsSUFBSSxvQkFBSixFQUFELENBQTJCLE9BQTNCLENBQW1DLFFBQW5DLENBQVA7QUFDRCIsImZpbGUiOiJoeWdpZW5lLXV0aWxzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtnZW5zeW19IGZyb20gXCIuL3N5bWJvbFwiO1xuaW1wb3J0IHtWYXJCaW5kaW5nVHJhbnNmb3JtLCBDb21waWxldGltZVRyYW5zZm9ybX0gZnJvbSBcIi4vdHJhbnNmb3Jtc1wiO1xuaW1wb3J0ICAqIGFzIF8gZnJvbSBcInJhbWRhXCI7XG5pbXBvcnQge2V4cGVjdCwgYXNzZXJ0fSBmcm9tIFwiLi9lcnJvcnNcIjtcbmltcG9ydCBUZXJtLCB7aXNFT0YsIGlzQmluZGluZ0lkZW50aWZpZXIsIGlzQmluZGluZ1Byb3BlcnR5UHJvcGVydHksIGlzQmluZGluZ1Byb3BlcnR5SWRlbnRpZmllciwgaXNPYmplY3RCaW5kaW5nLCBpc0FycmF5QmluZGluZywgaXNGdW5jdGlvbkRlY2xhcmF0aW9uLCBpc0Z1bmN0aW9uRXhwcmVzc2lvbiwgaXNGdW5jdGlvblRlcm0sIGlzRnVuY3Rpb25XaXRoTmFtZSwgaXNTeW50YXhEZWNsYXJhdGlvbiwgaXNTeW50YXhyZWNEZWNsYXJhdGlvbiwgaXNWYXJpYWJsZURlY2xhcmF0aW9uLCBpc1ZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQsIGlzSW1wb3J0LCBpc0V4cG9ydCwgaXNQcmFnbWEsIGlzRXhwb3J0U3ludGF4fSBmcm9tIFwiLi90ZXJtc1wiO1xuaW1wb3J0IHtMaXN0fSBmcm9tIFwiaW1tdXRhYmxlXCI7XG5pbXBvcnQgQVNURGlzcGF0Y2hlciBmcm9tIFwiLi9hc3QtZGlzcGF0Y2hlclwiO1xuZXhwb3J0IGNsYXNzIENvbGxlY3RCaW5kaW5nU3ludGF4IGV4dGVuZHMgQVNURGlzcGF0Y2hlciB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKFwiY29sbGVjdFwiLCB0cnVlKTtcbiAgICB0aGlzLm5hbWVzID0gTGlzdCgpO1xuICB9XG4gIGNvbGxlY3QodGVybV8zMjIpIHtcbiAgICByZXR1cm4gdGhpcy5kaXNwYXRjaCh0ZXJtXzMyMik7XG4gIH1cbiAgY29sbGVjdEJpbmRpbmdJZGVudGlmaWVyKHRlcm1fMzIzKSB7XG4gICAgcmV0dXJuIHRoaXMubmFtZXMuY29uY2F0KHRlcm1fMzIzLm5hbWUpO1xuICB9XG4gIGNvbGxlY3RCaW5kaW5nUHJvcGVydHlJZGVudGlmaWVyKHRlcm1fMzI0KSB7XG4gICAgcmV0dXJuIHRoaXMuY29sbGVjdCh0ZXJtXzMyNC5iaW5kaW5nKTtcbiAgfVxuICBjb2xsZWN0QmluZGluZ1Byb3BlcnR5UHJvcGVydHkodGVybV8zMjUpIHtcbiAgICByZXR1cm4gdGhpcy5jb2xsZWN0KHRlcm1fMzI1LmJpbmRpbmcpO1xuICB9XG4gIGNvbGxlY3RBcnJheUJpbmRpbmcodGVybV8zMjYpIHtcbiAgICBsZXQgcmVzdEVsZW1lbnRfMzI3ID0gbnVsbDtcbiAgICBpZiAodGVybV8zMjYucmVzdEVsZW1lbnQgIT0gbnVsbCkge1xuICAgICAgcmVzdEVsZW1lbnRfMzI3ID0gdGhpcy5jb2xsZWN0KHRlcm1fMzI2LnJlc3RFbGVtZW50KTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMubmFtZXMuY29uY2F0KHJlc3RFbGVtZW50XzMyNykuY29uY2F0KHRlcm1fMzI2LmVsZW1lbnRzLmZpbHRlcihlbF8zMjggPT4gZWxfMzI4ICE9IG51bGwpLmZsYXRNYXAoZWxfMzI5ID0+IHRoaXMuY29sbGVjdChlbF8zMjkpKSk7XG4gIH1cbiAgY29sbGVjdE9iamVjdEJpbmRpbmcodGVybV8zMzApIHtcbiAgICByZXR1cm4gdGVybV8zMzAucHJvcGVydGllcy5mbGF0TWFwKHByb3BfMzMxID0+IHRoaXMuY29sbGVjdChwcm9wXzMzMSkpO1xuICB9XG59XG5leHBvcnQgZnVuY3Rpb24gY29sbGVjdEJpbmRpbmdzKHRlcm1fMzMyKSB7XG4gIHJldHVybiAobmV3IENvbGxlY3RCaW5kaW5nU3ludGF4KS5jb2xsZWN0KHRlcm1fMzMyKTtcbn1cbiJdfQ==